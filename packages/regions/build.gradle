plugins {
  id "com.moowork.node" // version "1.3.1"
}

cleanBuilt.delete fileTree('.') { include '*.jsx' }
cleanBuilt.delete fileTree('.') { include '*.ts' }
cleanBuilt.delete fileTree('.') { include '*.tsx' }
cleanBuilt.delete fileTree('.') { include '*.es' }
cleanBuilt.delete fileTree('.') { include '*.es6' }
cleanBuilt.delete fileTree('.') { include '*.*ss' }
cleanBuilt.delete fileTree('.') { include '*.*g' }
cleanBuilt.delete fileTree('.') { include '*.gif' }
cleanBuilt.delete fileTree('.') { include '*.ico' }
/* TODO: THE ABOVE WORKS. THE BELOW DOESN'T - SHOULDN'T IT? WOULD BE A BIT CLEANER:
[
  '*.js',
  '*.jsx',
  '*.ts',
  '*.tsx',
  '*.es',
  '*.es6',
  '*.*ss',
  '*.*g',
  '*.gif',
  '*.ico'
].each {
  cleanBuilt.delete fileTree('.') { include "${it.toString()}" }
}
*/
cleanBuilt.delete 'entries'

compileJS.enabled = false

lint.args=['run', 'lint']
lint.inputs.file('package.json')
lint.inputs.dir('src')
lint.dependsOn project.npmInstall

test.enabled = false
//test.args=['run', 'ADD SOME TESTS PLZ?']
//test.inputs.files('package.json')
//test.outputs.files('package.json')
//test.inputs.dir('src')
//test.outputs.dir('test/build')
//test.outputs.dir('test/output')

task copyFiles(type: Copy) {
  from 'src'
  into '.'
  include '*.*'
  include 'entries/**'
}
copyFiles.inputs.dir('src')
copyFiles.outputs.files('./*.jsx')
copyFiles.outputs.dir('entries')
build.dependsOn project.copyFiles

project.doPublish.shouldRunAfter ":packages:constants:doPublish"
