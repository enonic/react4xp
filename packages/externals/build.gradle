plugins {
  id "com.moowork.node" // version "1.3.1"
}

cleanBuilt.delete './webpack.config.js', 'build', './_AUTOGENERATED_tmp_externals_.es6', 'src/_AUTOGENERATED_tmp_externals_.es6'

compileJS.enabled = false


task prepareTest(type: NpmTask) {
  args=['run', 'test:prepare']
}
task runTest(type: NpmTask) {
  args=['run', 'test:webpack']
}
task cleanupTest(type: NpmTask) {
  args=['run', 'test:cleanup']
}
runTest.dependsOn prepareTest
cleanupTest.dependsOn runTest
testAll.dependsOn cleanupTest


testAll.args=['run', 'test:main']
testAll.outputs.dir('test/output')

task copyFiles(type: Copy) {
  from 'src'
  into '.'
  include '*.*'
}
copyFiles.inputs.dir('src')
copyFiles.outputs.files('./webpack.config.js')
buildAll.dependsOn += project.copyFiles
