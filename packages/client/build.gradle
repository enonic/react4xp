plugins {
  id "com.moowork.node" // version "1.3.1"
}

cleanBuilt.delete './react4xpClient.es6', './webpack.config.js', 'build', 'test/output'

compileJS.enabled = false

task prepareTest(type: NpmTask) {
  args=['run', 'test:prepare']
}
task runTest(type: NpmTask) {
  args=['run', 'test:webpack']
}
task cleanupTest(type: NpmTask) {
  args=['run', 'test:cleanup']
}
runTest.dependsOn prepareTest
cleanupTest.dependsOn runTest
testAll.dependsOn cleanupTest

testAll.args=['run', 'test:main']
testAll.outputs.dir('test/output')

task copyFiles(type: Copy) {
  from 'src'
  into '.'
  include '*.*'
}
copyFiles.inputs.dir('src')
copyFiles.outputs.files('./react4xpClient.es6', './webpack.config.js')
buildAll.dependsOn project.copyFiles
